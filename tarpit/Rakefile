# -*- ruby -*-

$LOAD_PATH << './lib'
require 'rubygems'

# Use same hoe version for building gem plus this gem's dependency
hoe_version = '~> 2.3.3'
gem     'hoe', hoe_version
require 'rjack-tarpit'

include RJack

t = TarPit.new( 'rjack-tarpit', TarPit::VERSION )

t.specify do |h|
  h.developer( 'David Kellum', 'dek-oss@gravitext.com' )
  h.extra_deps += [ [ 'rdoc',      '>= 2.5.11', '< 3.1' ],
                    [ 'rubyforge', '~> 1.0.3'  ],
                    [ 'hoe',       hoe_version ] ]
  h.rubyforge_name = 'rjack'
  h.remote_rdoc_dir = 'tarpit'
end

task :check_history_version do
  t.test_line_match( 'History.rdoc', /^==/, / #{ t.version } / )
end
task :check_sample_version do
  t.test_line_match( 'README.rdoc', /^\s*gem.+#{ t.name }/, /#{ t.version }/ )
end
task :check_history_date do
  t.test_line_match( 'History.rdoc', /^==/, /\([0-9\-]+\)$/ )
end

task :gem  => [ :check_history_version, :check_sample_version  ]
task :tag  => [ :check_history_version, :check_sample_version, :check_history_date ]
task :push => [ :check_history_version, :check_sample_version, :check_history_date ]

task :test #noop

t.define_tasks
